"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = parser;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var _eval = require("eval");

var _eval2 = _interopRequireDefault(_eval);

var _jsYaml = require("js-yaml");

var _jsYaml2 = _interopRequireDefault(_jsYaml);

var _stripJsonComments = require("strip-json-comments");

var _stripJsonComments2 = _interopRequireDefault(_stripJsonComments);

function parser(content, file) {
  try {
    return _jsYaml2["default"].safeLoad((0, _stripJsonComments2["default"])(content));
  } catch (e) {
    // `(module.)exports` = JS ?
    if (/exports/.test(content)) {
      return (0, _eval2["default"])(content);
    }

    throw new Error("Cannot parse runtime configuration as YAML, JSON or JS" + (file ? "from '" + file + "'" : ""));
  }
}

module.exports = exports["default"];